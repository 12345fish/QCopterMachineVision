/*=====================================================================================================*/
/*=====================================================================================================*/
#include "stm32f4_system.h"
#include "system_camera.h"
#include "ff.h"
#include "diskio.h"
/*=====================================================================================================*/
/*=====================================================================================================*
**函數 : Camera_Enable
**功能 : 開始轉換圖片
**輸入 : None
**輸出 : None
**使用 : Camera_Enable();
**=====================================================================================================*/
/*=====================================================================================================*/
void Camera_Enable( void )
{
  DMA_Cmd(DMA2_Stream1, ENABLE);
  DCMI_Cmd(ENABLE);
  DCMI_CaptureCmd(ENABLE);
}
/*=====================================================================================================*/
/*=====================================================================================================*
**函數 : Camera_Photograph
**功能 : Take a picture
**輸入 : None
**輸出 : None
**使用 : Camera_Photograph();
**=====================================================================================================*/
/*=====================================================================================================*/
u8 Camera_Photograph( const char* Path, const void* ImageBuf, uc32 ImageSize )
{
  FIL file;
  FRESULT res;
  u32 i = 0;

  DCMI_CaptureCmd(ENABLE);

  res = f_open(&file, Path, FA_CREATE_NEW | FA_WRITE);
  if(res != FR_OK)
    return ERROR;
  f_lseek(&file, 0);
  f_write(&file, ImageBuf, ImageSize, &i);
  f_close(&file);

  return SUCCESS;
}
/*=====================================================================================================*/
/*=====================================================================================================*/
